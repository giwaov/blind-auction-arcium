"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[223],{624:(e,t,r)=>{e.exports=r.p+"static/media/miden_client_web.1c58f26d.wasm"},2484:(e,t,r)=>{r.d(t,{A:()=>i});async function i(){return await Promise.resolve().then(r.bind(r,7874))}},6400:(e,t,r)=>{r.a(e,async(e,i)=>{try{r.d(t,{AccountBuilder:()=>a.AccountBuilder,AccountComponent:()=>a.AccountComponent,AccountStorageMode:()=>a.AccountStorageMode,AccountStorageRequirements:()=>a.AccountStorageRequirements,AccountType:()=>a.AccountType,Address:()=>a.Address,Felt:()=>a.Felt,ForeignAccount:()=>a.ForeignAccount,FungibleAsset:()=>a.FungibleAsset,MidenArrays:()=>w,Note:()=>a.Note,NoteAndArgs:()=>a.NoteAndArgs,NoteAndArgsArray:()=>a.NoteAndArgsArray,NoteAssets:()=>a.NoteAssets,NoteType:()=>a.NoteType,OutputNote:()=>a.OutputNote,SecretKey:()=>a.SecretKey,StorageMap:()=>a.StorageMap,StorageSlot:()=>a.StorageSlot,TransactionProver:()=>a.TransactionProver,TransactionRequestBuilder:()=>a.TransactionRequestBuilder,WebClient:()=>u});var n=r(2484),a=r(7874),s=e([a]);a=(s.then?(await s)():s)[0];let o=Object.freeze({INIT:"init",CALL_METHOD:"callMethod"}),l=Object.freeze({CREATE_CLIENT:"createClient",NEW_WALLET:"newWallet",NEW_FAUCET:"newFaucet",EXECUTE_TRANSACTION:"executeTransaction",PROVE_TRANSACTION:"proveTransaction",SUBMIT_NEW_TRANSACTION:"submitNewTransaction",SUBMIT_NEW_TRANSACTION_MOCK:"submitNewTransactionMock",SYNC_STATE:"syncState",SYNC_STATE_MOCK:"syncStateMock"}),c=await (0,n.A)(),w=Object.entries(c).reduce((e,[t,r])=>(t.endsWith("Array")&&(e[t]=r),e),{}),{WebClient:h}=c;class u{constructor(e,t,i,n,a,s){this.rpcUrl=e,this.noteTransportUrl=t,this.seed=i,this.getKeyCb=n,this.insertKeyCb=a,this.signCb=s,!("u">typeof Worker)||this.getKeyCb||this.insertKeyCb||this.signCb?(console.log("WebClient: Web Workers are not available."),this.worker=null,this.pendingRequests=null,this.loaded=Promise.resolve(),this.ready=Promise.resolve()):(console.log("WebClient: Web Workers are available."),this.worker=new Worker(r.tu(new URL(r.p+r.u(174),r.b)),{type:void 0}),this.pendingRequests=new Map,this.loaded=new Promise(e=>{this.loadedResolver=e}),this.ready=new Promise(e=>{this.readyResolver=e}),this.worker.addEventListener("message",e=>{let t=e.data;if(t.loaded)return void this.loadedResolver();if(t.ready)return void this.readyResolver();let{requestId:r,error:i,result:n,methodName:a}=t;if(r&&this.pendingRequests.has(r)){let{resolve:e,reject:t}=this.pendingRequests.get(r);this.pendingRequests.delete(r),i?(console.error(`WebClient: Error from worker in ${a}:`,i),t(Error(i))):e(n)}}),this.loaded.then(()=>{this.worker.postMessage({action:o.INIT,args:[this.rpcUrl,this.noteTransportUrl,this.seed,this.getKeyCb,this.insertKeyCb,this.signCb]})})),this.wasmWebClient=new h}static async createClient(e,t,r){let i=new u(e,t,r);return await i.wasmWebClient.createClient(e,t,r),await i.ready,new Proxy(i,{get(e,t,r){if(t in e)return Reflect.get(e,t,r);if(e.wasmWebClient&&t in e.wasmWebClient){let r=e.wasmWebClient[t];return"function"==typeof r?r.bind(e.wasmWebClient):r}}})}static async createClientWithExternalKeystore(e,t,r,i,n,a){let s=new u(e,t,r,i,n,a);return await s.wasmWebClient.createClientWithExternalKeystore(e,t,r,i,n,a),await s.ready,new Proxy(s,{get(e,t,r){if(t in e)return Reflect.get(e,t,r);if(e.wasmWebClient&&t in e.wasmWebClient){let r=e.wasmWebClient[t];return"function"==typeof r?r.bind(e.wasmWebClient):r}}})}async callMethodWithWorker(e,...t){await this.ready;let r=`${e}-${Date.now()}-${Math.random()}`;return new Promise((i,n)=>{this.pendingRequests.set(r,{resolve:i,reject:n}),this.worker.postMessage({action:o.CALL_METHOD,methodName:e,args:t,requestId:r})})}async newWallet(e,t,r,i){try{if(!this.worker)return await this.wasmWebClient.newWallet(e,t,r,i);let n=e.asStr(),a=await this.callMethodWithWorker(l.NEW_WALLET,n,t,r,i);return c.Account.deserialize(new Uint8Array(a))}catch(e){throw console.error("INDEX.JS: Error in newWallet:",e.toString()),e}}async newFaucet(e,t,r,i,n,a){try{if(!this.worker)return await this.wasmWebClient.newFaucet(e,t,r,i,n,a);let s=e.asStr(),o=n.toString(),w=await this.callMethodWithWorker(l.NEW_FAUCET,s,t,r,i,o,a);return c.Account.deserialize(new Uint8Array(w))}catch(e){throw console.error("INDEX.JS: Error in newFaucet:",e.toString()),e}}async submitNewTransaction(e,t){try{if(!this.worker)return await this.wasmWebClient.submitNewTransaction(e,t);let r=t.serialize(),i=await this.callMethodWithWorker(l.SUBMIT_NEW_TRANSACTION,e.toString(),r);return c.TransactionResult.deserialize(new Uint8Array(i.serializedTransactionResult)).id()}catch(e){throw console.error("INDEX.JS: Error in submitNewTransaction:",e.toString()),e}}async executeTransaction(e,t){try{if(!this.worker)return await this.wasmWebClient.executeTransaction(e,t);let r=t.serialize(),i=await this.callMethodWithWorker(l.EXECUTE_TRANSACTION,e.toString(),r);return c.TransactionResult.deserialize(new Uint8Array(i))}catch(e){throw console.error("INDEX.JS: Error in executeTransaction:",e.toString()),e}}async submitTransaction(e,t){try{if(!this.worker){let r=await this.wasmWebClient.proveTransaction(e,t),i=await this.wasmWebClient.submitProvenTransaction(r,e);return await this.wasmWebClient.applyTransaction(e,i)}let r=e.serialize(),i=t?t.serialize():null,{submissionHeight:n,serializedTransactionUpdate:a}=await this.callMethodWithWorker(l.SUBMIT_TRANSACTION,r,i);if(this instanceof d)return c.TransactionStoreUpdate.deserialize(new Uint8Array(a));return await this.wasmWebClient.applyTransaction(e,n)}catch(e){throw console.error("INDEX.JS: Error in submitTransaction:",e.toString()),e}}async proveTransaction(e,t){try{if(!this.worker)return await this.wasmWebClient.proveTransaction(e,t);let r=e.serialize(),i=t?t.serialize():null,n=await this.callMethodWithWorker(l.PROVE_TRANSACTION,r,i);return c.ProvenTransaction.deserialize(new Uint8Array(n))}catch(e){throw console.error("INDEX.JS: Error in proveTransaction:",e.toString()),e}}async syncState(){try{if(!this.worker)return await this.wasmWebClient.syncState();let e=await this.callMethodWithWorker(l.SYNC_STATE);return c.SyncSummary.deserialize(new Uint8Array(e))}catch(e){throw console.error("INDEX.JS: Error in syncState:",e.toString()),e}}terminate(){this.worker.terminate()}}Object.getOwnPropertyNames(h).forEach(e=>{"function"==typeof h[e]&&"constructor"!==e&&"prototype"!==e&&(u[e]=h[e])});class d extends u{constructor(e){super(null,e)}static async createClient(e,t,r){let i=new d(r);return await i.wasmWebClient.createMockClient(r,e,t),await i.ready,new Proxy(i,{get(e,t,r){if(t in e)return Reflect.get(e,t,r);if(e.wasmWebClient&&t in e.wasmWebClient){let r=e.wasmWebClient[t];return"function"==typeof r?r.bind(e.wasmWebClient):r}}})}async syncState(){try{if(!this.worker)return await this.wasmWebClient.syncState();let e=this.wasmWebClient.serializeMockChain().buffer,t=this.wasmWebClient.serializeMockNoteTransportNode().buffer,r=await this.callMethodWithWorker(l.SYNC_STATE_MOCK,e,t);return c.SyncSummary.deserialize(new Uint8Array(r))}catch(e){throw console.error("INDEX.JS: Error in syncState:",e.toString()),e}}async submitTransaction(e,t){try{if(!this.worker)return await super.submitTransaction(e,t);let r=e.serialize(),i=t?t.serialize():null,n=this.wasmWebClient.serializeMockChain().buffer,a=this.wasmWebClient.serializeMockNoteTransportNode().buffer,s=await this.callMethodWithWorker(l.SUBMIT_TRANSACTION_MOCK,r,i,n,a),o=new Uint8Array(s.serializedMockChain),w=s.serializedMockNoteTransportNode?new Uint8Array(s.serializedMockNoteTransportNode):void 0;if(!(this instanceof d))return await this.wasmWebClient.applyTransaction(e,s.submissionHeight);return this.wasmWebClient=new h,await this.wasmWebClient.createMockClient(this.seed,o,w),c.TransactionStoreUpdate.deserialize(new Uint8Array(s.serializedTransactionUpdate))}catch(e){throw console.error("INDEX.JS: Error in submitTransaction:",e.toString()),e}}async submitNewTransaction(e,t){try{if(!this.worker)return await super.submitNewTransaction(e,t);let r=t.serialize(),i=this.wasmWebClient.serializeMockChain().buffer,n=this.wasmWebClient.serializeMockNoteTransportNode().buffer,a=await this.callMethodWithWorker(l.SUBMIT_NEW_TRANSACTION_MOCK,e.toString(),r,i,n),s=new Uint8Array(a.serializedMockChain),o=a.serializedMockNoteTransportNode?new Uint8Array(a.serializedMockNoteTransportNode):void 0,w=c.TransactionResult.deserialize(new Uint8Array(a.serializedTransactionResult));if(!(this instanceof d))return w.id();return this.wasmWebClient=new h,await this.wasmWebClient.createMockClient(this.seed,s,o),w.id()}catch(e){throw console.error("INDEX.JS: Error in submitNewTransaction:",e.toString()),e}}}i()}catch(e){i(e)}},1)}}]);